import{r as c,j as e,S as L,s as N,I as E,c as P,a as B,b as z,u as $,F as A,d as t,L as F,e as D,B as C,o as R,f as j,h as se,g as he,i as ce}from"./index-a3e82b42.js";import{S as de,P as ge}from"./PaginationComponent-e7829c56.js";import{d as w}from"./Add-9694775e.js";import{q as ue}from"./base-312a79a2.js";import{D as pe}from"./DialogDelete-56ef9c2c.js";import{q as k}from"./quanham-ec24fa59.js";import{d as W}from"./AutoAwesomeMotion-8a5a096b.js";import{D as I,d as M}from"./Cancel-62c222e1.js";import{D as G,a as K}from"./DialogContent-66228f14.js";import{B as V}from"./Box-7be78753.js";import{G as b}from"./Grid-f09340a2.js";import{D as Q}from"./DialogActions-759a18d8.js";import{T as me,a as fe,b as be,c as H,d as m,e as xe,f as ye}from"./Edit-1fc0b27c.js";import{d as De}from"./DeleteOutline-95df8af9.js";import"./DialogContentText-e4ee471d.js";const ve=c.forwardRef(function(a,l){return e(L,{direction:"up",ref:l,...a})}),Se=N(E)({position:"absolute",right:"16px",top:"4px"}),Ce=P({hesoluong:B().required("Lỗi: Vui lòng nhập hệ số lương"),thutu:z().required("Lỗi: Vui lòng nhập thứ tự").min(1,"Thứ tự phải lớn hơn 1"),nienhanlenluong:z().required("Lỗi: Vui lòng nhập niên hạn lên lương tiếp theo")}).required();function Te({open:u,item:a,onCloseDialogEdit:l,onSubmit:h}){const s=$({defaultValues:{hesoluong:"",nienhanlenluong:1,thutu:1},resolver:R(Ce)}),o=s.setValue;c.useEffect(()=>{a&&(o("hesoluong",a.hesoluong,{shouldValidate:!0}),o("thutu",a.thutu,{shouldValidate:!0}),o("nienhanlenluong",a.nienhanlenluong,{shouldValidate:!0}))},[a]);const r=async v=>{if(h){const f={...v,id_edit:a._id};await h(f),l()}},{isSubmitting:d}=s.formState;return e(A,{children:t(G,{maxWidth:"lg",fullWidth:!0,disableEscapeKeyDown:!0,onClose:(v,f)=>{f!=="backdropClick"&&l(v,f)},open:u,TransitionComponent:ve,keepMounted:!0,"aria-describedby":"alert-dialog-slide-description",children:[t(I,{style:{display:"flex",borderBottom:"1px solid #ccc",margin:"0 12px"},children:[e(W,{style:{color:"#333",fontSize:"32px"}}),e("span",{children:"Chỉnh sửa cấp bậc hàm"}),e(Se,{onClick:()=>l(),children:e(M,{style:{color:"#d32b2b"}})})]}),e(K,{children:t(V,{children:[d?e(F,{}):"",t("form",{onSubmit:s.handleSubmit(r),style:{width:"100%"},children:[t(b,{container:!0,spacing:1,style:{alignItems:"center",justifyContent:"center"},children:[e(b,{item:!0,xs:12,md:6,lg:6,children:e(D,{name:"hesoluong",form:s,label:"Hệ số lương *",type:"text",disabled:!1})}),e(b,{item:!0,xs:12,md:3,lg:3,children:e(D,{name:"nienhanlenluong",form:s,label:"Niên hạn lên lương kế tiếp tính theo năm*",type:"number",disabled:!1})}),e(b,{item:!0,xs:12,md:3,lg:3,children:e(D,{name:"thutu",form:s,label:"Thứ tự",type:"number",disabled:!1})})]}),e(Q,{children:t(C,{color:"primary",variant:"contained",disabled:d,type:"submit",style:{margin:"4px auto"},children:[e(w,{}),e("span",{children:"Cập nhật"})]})})]})]})})]})})}const ke=c.forwardRef(function(a,l){return e(L,{direction:"up",ref:l,...a})}),ze=N(E)({position:"absolute",right:"16px",top:"4px"}),Oe=P({hesoluong:B().required("Lỗi: Vui lòng nhập hệ số lương"),thutu:z().required("Lỗi: Vui lòng nhập thứ tự").min(1,"Thứ tự phải lớn hơn 1"),nienhanlenluong:z().required("Lỗi: Vui lòng nhập niên hạn lên lương tiếp theo")}).required();function we({open:u,onCloseDialogAdd:a,onSubmit:l}){const h=$({defaultValues:{hesoluong:"",nienhanlenluong:1,thutu:1},resolver:R(Oe)}),s=async r=>{l&&(await l(r),h.reset())},{isSubmitting:o}=h.formState;return e(A,{children:t(G,{maxWidth:"lg",fullWidth:!0,disableEscapeKeyDown:!0,onClose:(r,d)=>{d!=="backdropClick"&&a(r,d)},open:u,TransitionComponent:ke,keepMounted:!0,"aria-describedby":"alert-dialog-slide-description",children:[t(I,{style:{display:"flex",borderBottom:"1px solid #ccc",margin:"0 12px"},children:[e(W,{style:{color:"#333",fontSize:"32px"}}),e("span",{children:"Thêm mới hệ số lương"}),e(ze,{onClick:()=>a(),children:e(M,{style:{color:"#d32b2b"}})})]}),e(K,{children:t(V,{children:[o?e(F,{}):"",t("form",{onSubmit:h.handleSubmit(s),style:{width:"100%"},children:[t(b,{container:!0,spacing:1,style:{alignItems:"center",justifyContent:"center"},children:[e(b,{item:!0,xs:12,md:6,lg:6,children:e(D,{name:"hesoluong",form:h,label:"Hệ số lương *",type:"text",disabled:!1})}),e(b,{item:!0,xs:12,md:3,lg:3,children:e(D,{name:"nienhanlenluong",form:h,label:"Niên hạn lên lương kế tiếp tính theo năm*",type:"number",disabled:!1})}),e(b,{item:!0,xs:12,md:3,lg:3,children:e(D,{name:"thutu",form:h,label:"Thứ tự",type:"number",disabled:!1})})]}),e(Q,{children:t(C,{color:"primary",variant:"contained",disabled:o,type:"submit",style:{margin:"4px auto"},children:[e(w,{}),e("span",{children:"Thêm mới"})]})})]})]})})]})})}const Ve=({list:u,page:a,onClickOpenDialogDelete:l,onClickOpenDialogEdit:h,tongbanghi:s})=>{const o=j(r=>r.authReducer.roles_x01);return t(V,{mt:4,children:[t("p",{className:"text-end my-2",children:["Tổng cộng có: ",e("span",{className:"text-xl font-bold",children:s})," bản ghi"]}),e(me,{children:t(fe,{sx:{minWidth:650},"aria-label":"simple table",children:[e(be,{style:{backgroundColor:"#ed6c02"},children:t(H,{children:[e(m,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px"},children:"#"}),e(m,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px"},children:"Hệ số lương"}),e(m,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px"},children:"Niên hạn lên lương kế tiếp ( tính theo năm )"}),e(m,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px"},children:"Thứ tự"}),e(m,{align:"right",style:{fontSize:"14px",color:"#fff",padding:"8px 8px"},children:"Thao tác"})]})}),e(xe,{children:u.map((r,d)=>t(H,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[e(m,{component:"th",scope:"row",children:(a-1)*5+1+d}),e(m,{align:"left",style:{fontWeight:"bold"},children:r.hesoluong}),e(m,{align:"left",children:r.nienhanlenluong}),e(m,{align:"left",children:r.thutu}),t(m,{align:"right",children:[o&&o.includes("sửa hệ số lương")&&t(C,{variant:"contained",color:"success",size:"small",onClick:()=>h(r),children:[e(ye,{style:{fontSize:"20px",marginRight:"4px"}})," ","Sửa"]}),o&&o.includes("xóa hệ số lương")&&t(C,{variant:"contained",color:"error",size:"small",style:{marginLeft:"4px"},onClick:()=>l(r._id),children:[e(De,{style:{fontSize:"20px",marginRight:"4px"}})," ","Xóa"]})]})]},r._id))})]})})]})},Me=()=>{const u=j(n=>n.authReducer.roles_x01),[a,l]=c.useState({page:1,total:1});let[h,s]=se();const o=he(),[r,d]=c.useState(0),[v,f]=c.useState([]),x=c.useMemo(()=>{const n=ue.parse(location.search);return{...n,page:Number(n.page)||1}},[location.search]),[S,T]=c.useState({status:!1,id_Delete:null}),[O,q]=c.useState({status:!1,item:null}),[X,_]=c.useState(!1),[J,y]=c.useState(!1),U=()=>{_(!1)},Y=n=>{_(!0)},{enqueueSnackbar:g}=ce(),Z=n=>{l({...a,page:n});const i={...x,page:n};s(i)};c.useEffect(()=>{(async()=>{try{y(!0);let i=await k.getHesoluong(x);f(i.data.donvis),l({page:i.data.page,total:i.data.total}),d(i.data.tongbanghi),y(!1)}catch(i){i.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(o("/login"),g(i.message,{anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"error"})),g(i.response.data.message,{anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"error"}),y(!1)}})()},[x]);const ee=async n=>{try{let i={...n,queryParams:x};y(!0);let p=await k.addHesoluong(i);f(p.data.donvis),l({...a,total:p.data.total}),d(p.data.tongbanghi),y(!1),g("Thêm mới hệ số lương thành công!",{anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"success"})}catch(i){i.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(o("/login"),g(i.message,{anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"error"})),g(i.response.data.message,{anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"error"}),y(!1)}},ne=n=>{T({status:!0,id_Delete:n})},te=()=>{q({...O,status:!1})},ae=n=>{q({item:n,status:!0})},ie=()=>{T({...S,status:!1})},le=async n=>{const i={...n,queryParams:x};try{let p=await k.editHesoluong(i);f(p.data.donvis),g(p.data.message,{anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"success"})}catch(p){p.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(o("/login"),g(p.message,{anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"error"})),g(p.response.data.message,{anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"error"})}},oe=async()=>{try{let n=await k.deleteHesoluong(S.id_Delete,x);f(n.data.donvis),d(n.data.tongbanghi);const i={...x,page:1};s(i),T({...S,status:!1}),g(n.data.message,{anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"success"})}catch(n){n.message==="Token không hợp lệ hoặc đã hết hạn. Vui lòng đăng nhập lại"&&(o("/login"),g(n.message,{anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"error"})),g(n.response.data.message,{anchorOrigin:{vertical:"bottom",horizontal:"right"},variant:"error"})}},re=()=>{T({...S,status:!1})};return t("div",{className:"mx-2 bg-white pb-2 px-4",children:[e("img",{className:"w-[80px] m-auto mt-2 pt-2",src:"https://thuviensocongantinhhungyen.vercel.app/cong-an-hieu.png",alt:"anhnen"}),e("h3",{className:"text-xl text-gray-900 text-center font-bold",children:"Quản lý hệ số lương và niên hạn lên lương kế tiếp theo qui định, chế độ trong lực lượng CAND"}),u&&u.includes("thêm hệ số lương")&&e("div",{className:"text-end mb-4",children:t(C,{variant:"contained",onClick:Y,children:[e(w,{}),"Thêm mới hệ số lương"]})}),e("div",{children:J?e(de,{variant:"rectangular",width:"100%",height:400}):e(Ve,{list:v,page:a.page,onClickOpenDialogDelete:ne,onClickOpenDialogEdit:ae,tongbanghi:r})}),e(we,{open:X,onCloseDialogAdd:U,onSubmit:ee}),e(Te,{open:O.status,item:O.item,onCloseDialogEdit:te,onSubmit:le}),e(pe,{open:S.status,onCloseDialogDelete:ie,onConfirmDelete:oe,onCancelDelete:re}),e(ge,{page:a.page,totalPage:a.total,onChangePage:Z})]})};export{Me as default};
