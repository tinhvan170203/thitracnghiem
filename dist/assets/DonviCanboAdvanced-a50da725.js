import{X as $,j as e,S as oe,s as re,I as v,c as se,a as F,u as ce,o as de,an as he,r as d,f as ge,d as n,F as pe,P as ue,B as y,L as me,e as fe,H as be}from"./index-e0961e99.js";import{d as xe,a as ye}from"./SaveAlt-31e07f63.js";import{p as C}from"./index-4d501b15.js";import{T as ve,d as V,a as W,b as j,c as A}from"./LastPage-1b1710eb.js";import{d as w}from"./dayjs.min-615384ab.js";import{T as De,a as Ce,b as Se,c as R,d as r,e as Pe,f as _e}from"./Edit-5d2efbfb.js";import{d as ke,a as Te,b as we}from"./DeleteOutline-0af1bb5e.js";import{d as Re}from"./AutoAwesomeMotion-af10e1ab.js";import{D as O,d as E}from"./Cancel-144df7f9.js";import{c as $e}from"./commonApi-a870f7fb.js";import{S as Ne}from"./index-a71d3087.js";import{D as Be}from"./index-0db03f4a.js";import{D as I,a as G}from"./DialogContent-799bdaed.js";import{B as Y}from"./Box-840ed356.js";import{G as S}from"./Grid-1a838762.js";import{D as ze}from"./DialogActions-57bf780a.js";import"./KeyboardArrowRight-9c20a043.js";import"./Toolbar-bee99cee.js";import"./MenuItem-38c8e3d3.js";import"./axiosCommon-0c664930.js";const H=$.forwardRef(function(l,g){return e(oe,{direction:"up",ref:g,...l})}),qe=re(v)({position:"absolute",right:"16px",top:"4px"});function K(s){const l=be(),{count:g,page:h,rowsPerPage:a,onPageChange:u}=s,P=c=>{u(c,0)},f=c=>{u(c,h-1)},_=c=>{u(c,h+1)},b=c=>{u(c,Math.max(0,Math.ceil(g/a)-1))};return n(Y,{sx:{flexShrink:0,ml:2.5},children:[e(v,{onClick:P,disabled:h===0,"aria-label":"first page",children:l.direction==="rtl"?e(V,{}):e(W,{})}),e(v,{onClick:f,disabled:h===0,"aria-label":"previous page",children:l.direction==="rtl"?e(j,{}):e(A,{})}),e(v,{onClick:_,disabled:h>=Math.ceil(g/a)-1,"aria-label":"next page",children:l.direction==="rtl"?e(A,{}):e(j,{})}),e(v,{onClick:b,disabled:h>=Math.ceil(g/a)-1,"aria-label":"last page",children:l.direction==="rtl"?e(W,{}):e(V,{})})]})}K.propTypes={count:C.number.isRequired,onPageChange:C.func.isRequired,page:C.number.isRequired,rowsPerPage:C.number.isRequired};const Le=se({donvi:F().required("Vui lòng chọn đơn vị công tác"),ngayvedonvi:F().required("Vui lòng chọn ngày về đơn vị công tác")}).required(),nt=()=>{var L;const s=ce({defaultValues:{donvi:"",ghichu:"",ngayvedonvi:w(Date.now())},resolver:de(Le)}),{canbo:l,onHandleSubmitEditDonvi:g,onHandleSubmitDeleteDonvi:h}=he(),[a,u]=d.useState([]),[P,f]=d.useState(!1),[_,b]=d.useState(!1),[c,X]=d.useState([]),[o,J]=d.useState(null),[Q,U]=d.useState(null),D=ge(t=>t.authReducer.roles_x01),[m,N]=$.useState(0),[p,Z]=$.useState(10),B=m>0?Math.max(0,(1+m)*p-(a==null?void 0:a.length)):0,ee=(t,i)=>{N(i)},te=t=>{Z(parseInt(t.target.value,10)),N(0)},z=()=>{f(!1)},q=()=>{b(!1)},ne=t=>{f(!0),J(t)},ae=t=>{b(!0),U(t)};d.useEffect(()=>{u(l==null?void 0:l.donvi)},[l]),d.useEffect(()=>{(async()=>{try{let i=await $e.getDanhsachDonvi();X(i.data.donvis.map(x=>({value:x._id,label:x.tendonvi})))}catch(i){console.log(i.message)}})()},[]),d.useEffect(()=>{k("donvi",(o==null?void 0:o.donvi._id)||"",{shouldValidate:!0}),k("ngayvedonvi",w(o==null?void 0:o.tungay),{shouldValidate:!0}),k("ghichu",(o==null?void 0:o.ghichu)||"",{shouldValidate:!0})},[o]);const k=s.setValue,{isSubmitting:T}=s.formState,ie=async t=>{let i={...t,id_edit:l._id,id_row:o._id};await g(i),f(!1)},le=async()=>{let t={id_delete:l._id,id_row:Q};await h(t),b(!1)};return n("div",{children:[e("i",{children:"Nhắc nhở: Khi thay đổi đơn vị công tác cần thay đổi cả đội nghiệp vụ, công an xã, phường, thị trấn đồng thời để tránh gây lỗi dữ liệu hệ thống."}),n("div",{className:"flex items-center space-x-2 mt-8 mb-4",children:[e(xe,{color:"info"}),e("span",{className:"text-md text-red-800 font-bold",children:"Lịch sử biến động đơn vị công tác trong quá trình công tác"})]}),(a==null?void 0:a.length)>0&&n(pe,{children:[e(De,{component:ue,style:{overflowX:"scroll"},children:n(Ce,{"aria-label":"custom pagination table",children:[e(Se,{children:n(R,{children:[e(r,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#ed6c02",maxWidth:"250px"},children:"#"}),e(r,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#ed6c02",minWidth:"250px"},children:"Tên đơn vị"}),e(r,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#ed6c02",minWidth:"120px"},children:"Ngày có quyết định về đơn vị"}),e(r,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#ed6c02",minWidth:"300px"},children:"Ghi chú"}),e(r,{align:"right",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#ed6c02"},children:"Thao tác"})]})}),n(Pe,{children:[(L=p>0?a==null?void 0:a.slice(m*p,m*p+p):a)==null?void 0:L.map((t,i)=>n(R,{children:[e(r,{className:"border-r border-slate-300",component:"th",scope:"row",children:m*p+i+1}),e(r,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:t.donvi.tendonvi}),e(r,{className:"border-r border-slate-300",align:"left",children:w(t.tungay).format("DD/MM/YYYY")}),e(r,{className:"border-r border-slate-300",align:"left",children:t.ghichu}),n(r,{align:"right",className:"border-r border-slate-300",children:[D&&D.includes("sửa biến động đơn vị")&&n(y,{variant:"contained",color:"success",size:"small",onClick:()=>ne(t),children:[e(_e,{style:{fontSize:"20px",marginRight:"4px"}})," ","Sửa"]}),D&&D.includes("xóa biến động đơn vị")&&n(y,{variant:"contained",color:"error",size:"small",style:{marginLeft:"4px"},onClick:()=>ae(t._id),children:[e(ke,{style:{fontSize:"20px",marginRight:"4px"}})," ","Xóa"]})]})]},t._id)),B>0&&e(R,{style:{height:53*B},children:e(r,{colSpan:6})})]})]})}),e("div",{children:e(ve,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:a==null?void 0:a.length,rowsPerPage:p,page:m,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:ee,onRowsPerPageChange:te,ActionsComponent:K,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:i,to:x,count:M}){return`hiển thị ${i} đến ${x} bản ghi trong tổng số ${M!==-1?M:`more than ${x}`} bản ghi`}})})]}),n(I,{maxWidth:"lg",fullWidth:!0,disableEscapeKeyDown:!0,onClose:(t,i)=>{i!=="backdropClick"&&z()},open:P,TransitionComponent:H,keepMounted:!0,"aria-describedby":"alert-dialog-slide-description",children:[n(O,{style:{display:"flex",borderBottom:"1px solid #ccc",margin:"0 12px"},children:[e(Re,{style:{color:"#333",fontSize:"32px"}}),e("span",{className:"text-red-800 font-semibold",children:"Thay đổi hệ số lương nâng cao"}),e(qe,{onClick:()=>z(),children:e(E,{style:{color:`${T?"#ccc":"#d32b2b"}`}})})]}),e(G,{children:n(Y,{children:[T?e(me,{}):"",n("form",{onSubmit:s.handleSubmit(ie),style:{width:"100%"},children:[n(S,{container:!0,spacing:1,style:{alignItems:"center",justifyContent:"center"},children:[e(S,{item:!0,xs:12,md:6,lg:6,children:e(Ne,{name:"donvi",form:s,label:"Đơn vị công tác *",disabled:!1,options:c})}),e(S,{item:!0,xs:12,md:6,lg:6,children:e(Be,{name:"ngayvedonvi",form:s,label:"Ngày nhận quyết định công tác tại đơn vị *",disabled:!1})}),e(S,{item:!0,xs:12,md:12,lg:12,children:e(fe,{name:"ghichu",form:s,label:"Ghi chú",type:"text",disabled:!1})})]}),e(ze,{children:n(y,{color:"primary",variant:"contained",disabled:T,type:"submit",style:{margin:"4px auto"},children:[e(ye,{}),e("span",{className:"ml-2",children:"Lưu dữ liệu"})]})})]})]})})]}),n(I,{disableEscapeKeyDown:!0,onClose:(t,i)=>{i!=="backdropClick"&&q()},open:_,TransitionComponent:H,keepMounted:!0,"aria-describedby":"alert-dialog-slide-description",children:[n(O,{style:{display:"flex",borderBottom:"1px solid #ccc",margin:"0 12px"},children:[e(Te,{style:{color:"red",fontSize:"32px"}}),e("span",{children:"Bạn có chắc chắn muốn xóa lần thay đổi đơn vị này không?"})]}),e(G,{children:e("img",{className:"p-4 mx-auto",src:"https://www.iconexperience.com/_img/v_collection_png/256x256/shadow/garbage_delete.png",alt:"icon-trash"})}),n("div",{className:"flex justify-evenly pb-4",children:[n(y,{variant:"contained",color:"success",onClick:le,children:[e(we,{})," Đồng ý"]}),n(y,{variant:"contained",color:"error",onClick:()=>q(),children:[e(E,{})," Cancel"]})]})]})]})};export{nt as default};
