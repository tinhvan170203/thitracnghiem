import{X as R,j as e,S as oe,s as re,I as C,c as se,a as F,u as ce,o as de,ao as he,r as d,f as me,d as t,F as pe,P as ge,B as y,L as ue,e as fe,H as be}from"./index-062f957e.js";import{d as xe,a as ye}from"./SaveAlt-d521e76a.js";import{p as D}from"./index-4d501b15.js";import{T as Ce,d as V,a as W,b as j,c as A}from"./LastPage-d948916c.js";import{d as w}from"./dayjs.min-aac666db.js";import{T as Se,a as De,b as Pe,c as T,d as r,e as _e,f as ke}from"./Edit-863c701d.js";import{d as ve,a as Be,b as we}from"./DeleteOutline-948d5e41.js";import{d as Te}from"./AutoAwesomeMotion-31ff343a.js";import{D as O,d as E}from"./Cancel-8937e614.js";import{c as Re}from"./commonApi-0cde8b65.js";import{S as $e}from"./index-aefdd792.js";import{D as Ne}from"./index-eca20c5d.js";import{D as H,a as I}from"./DialogContent-f84fc6ad.js";import{B as Y}from"./Box-bf90436a.js";import{G as P}from"./Grid-a7040e01.js";import{D as ze}from"./DialogActions-f287847c.js";import"./KeyboardArrowRight-737b2a8a.js";import"./Toolbar-b498bb22.js";import"./MenuItem-e2fd54c1.js";import"./axiosCommon-bb0a1a26.js";const G=R.forwardRef(function(i,m){return e(oe,{direction:"up",ref:m,...i})}),qe=re(C)({position:"absolute",right:"16px",top:"4px"});function X(s){const i=be(),{count:m,page:h,rowsPerPage:l,onPageChange:g}=s,_=c=>{g(c,0)},f=c=>{g(c,h-1)},k=c=>{g(c,h+1)},b=c=>{g(c,Math.max(0,Math.ceil(m/l)-1))};return t(Y,{sx:{flexShrink:0,ml:2.5},children:[e(C,{onClick:_,disabled:h===0,"aria-label":"first page",children:i.direction==="rtl"?e(V,{}):e(W,{})}),e(C,{onClick:f,disabled:h===0,"aria-label":"previous page",children:i.direction==="rtl"?e(j,{}):e(A,{})}),e(C,{onClick:k,disabled:h>=Math.ceil(m/l)-1,"aria-label":"next page",children:i.direction==="rtl"?e(A,{}):e(j,{})}),e(C,{onClick:b,disabled:h>=Math.ceil(m/l)-1,"aria-label":"last page",children:i.direction==="rtl"?e(W,{}):e(V,{})})]})}X.propTypes={count:D.number.isRequired,onPageChange:D.func.isRequired,page:D.number.isRequired,rowsPerPage:D.number.isRequired};const Le=se({bacham:F().required("Vui lòng chọn cấp bậc hàm"),ngaylenham:F().required("Vui lòng chọn ngày bắt đầu giữ bậc hàm")}).required(),ta=()=>{var L;const s=ce({defaultValues:{bacham:"",ghichu:"",ngaylenham:w(Date.now())},resolver:de(Le)}),{canbo:i,onHandleSubmitEditBacham:m,onHandleSubmitDeleteBacham:h}=he(),[l,g]=d.useState([]),[_,f]=d.useState(!1),[k,b]=d.useState(!1),[c,K]=d.useState([]),[o,J]=d.useState(null),[Q,U]=d.useState(null),S=me(a=>a.authReducer.roles_x01),[u,$]=R.useState(0),[p,Z]=R.useState(10),N=u>0?Math.max(0,(1+u)*p-(l==null?void 0:l.length)):0,ee=(a,n)=>{$(n)},ae=a=>{Z(parseInt(a.target.value,10)),$(0)},z=()=>{f(!1)},q=()=>{b(!1)},te=a=>{f(!0),J(a)},le=a=>{b(!0),U(a)};d.useEffect(()=>{g(i==null?void 0:i.bacham)},[i]),d.useEffect(()=>{(async()=>{try{let n=await Re.getBacHams();K(n.data.map(x=>({value:x._id,label:x.capham})))}catch(n){console.log(n.message)}})()},[]),d.useEffect(()=>{v("bacham",(o==null?void 0:o.bacham._id)||"",{shouldValidate:!0}),v("ngaylenham",w(o==null?void 0:o.tungay),{shouldValidate:!0}),v("ghichu",(o==null?void 0:o.ghichu)||"",{shouldValidate:!0})},[o]);const v=s.setValue,{isSubmitting:B}=s.formState,ne=async a=>{let n={...a,id_edit:i._id,id_row:o._id};await m(n),f(!1)},ie=async()=>{let a={id_delete:i._id,id_row:Q};await h(a),b(!1)};return t("div",{children:[t("div",{className:"flex items-center space-x-2 mt-8 mb-4",children:[e(xe,{color:"info"}),e("span",{className:"text-md text-red-800 font-bold",children:"Lịch sử biến động cấp bậc hàm trong quá trình công tác"})]}),(l==null?void 0:l.length)>0&&t(pe,{children:[e(Se,{component:ge,style:{overflowX:"scroll"},children:t(De,{"aria-label":"custom pagination table",children:[e(Pe,{children:t(T,{children:[e(r,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#ed6c02",maxWidth:"250px"},children:"#"}),e(r,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#ed6c02",minWidth:"250px"},children:"Cấp bậc hàm"}),e(r,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#ed6c02",minWidth:"120px"},children:"Ngày thay đổi cấp bậc hàm"}),e(r,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#ed6c02",minWidth:"300px"},children:"Ghi chú"}),e(r,{align:"right",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#ed6c02"},children:"Thao tác"})]})}),t(_e,{children:[(L=p>0?l==null?void 0:l.slice(u*p,u*p+p):l)==null?void 0:L.map((a,n)=>t(T,{children:[e(r,{className:"border-r border-slate-300",component:"th",scope:"row",children:u*p+n+1}),e(r,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:a.bacham.capham}),e(r,{className:"border-r border-slate-300",align:"left",children:w(a.tungay).format("DD/MM/YYYY")}),e(r,{className:"border-r border-slate-300",align:"left",children:a.ghichu}),t(r,{align:"right",className:"border-r border-slate-300",children:[S&&S.includes("sửa biến động bậc hàm")&&t(y,{variant:"contained",color:"success",size:"small",onClick:()=>te(a),children:[e(ke,{style:{fontSize:"20px",marginRight:"4px"}})," ","Sửa"]}),S&&S.includes("xóa biến động bậc hàm")&&t(y,{variant:"contained",color:"error",size:"small",style:{marginLeft:"4px"},onClick:()=>le(a._id),children:[e(ve,{style:{fontSize:"20px",marginRight:"4px"}})," ","Xóa"]})]})]},a._id)),N>0&&e(T,{style:{height:53*N},children:e(r,{colSpan:6})})]})]})}),e("div",{children:e(Ce,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:l==null?void 0:l.length,rowsPerPage:p,page:u,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:ee,onRowsPerPageChange:ae,ActionsComponent:X,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:n,to:x,count:M}){return`hiển thị ${n} đến ${x} bản ghi trong tổng số ${M!==-1?M:`more than ${x}`} bản ghi`}})})]}),t(H,{maxWidth:"lg",fullWidth:!0,disableEscapeKeyDown:!0,onClose:(a,n)=>{n!=="backdropClick"&&z()},open:_,TransitionComponent:G,keepMounted:!0,"aria-describedby":"alert-dialog-slide-description",children:[t(O,{style:{display:"flex",borderBottom:"1px solid #ccc",margin:"0 12px"},children:[e(Te,{style:{color:"#333",fontSize:"32px"}}),e("span",{className:"text-red-800 font-semibold",children:"Thay đổi chức vụ công tác nâng cao"}),e(qe,{onClick:()=>z(),children:e(E,{style:{color:`${B?"#ccc":"#d32b2b"}`}})})]}),e(I,{children:t(Y,{children:[B?e(ue,{}):"",t("form",{onSubmit:s.handleSubmit(ne),style:{width:"100%"},children:[t(P,{container:!0,spacing:1,style:{alignItems:"center",justifyContent:"center"},children:[e(P,{item:!0,xs:12,md:6,lg:6,children:e($e,{name:"bacham",form:s,label:"Cấp bậc hàm *",disabled:!1,options:c})}),e(P,{item:!0,xs:12,md:6,lg:6,children:e(Ne,{name:"ngaylenham",form:s,label:"Ngày nhận quyết định thay đổi cấp bậc hàm *",disabled:!1})}),e(P,{item:!0,xs:12,md:12,lg:12,children:e(fe,{name:"ghichu",form:s,label:"Ghi chú",type:"text",disabled:!1})})]}),e(ze,{children:t(y,{color:"primary",variant:"contained",disabled:B,type:"submit",style:{margin:"4px auto"},children:[e(ye,{}),e("span",{className:"ml-2",children:"Lưu dữ liệu"})]})})]})]})})]}),t(H,{disableEscapeKeyDown:!0,onClose:(a,n)=>{n!=="backdropClick"&&q()},open:k,TransitionComponent:G,keepMounted:!0,"aria-describedby":"alert-dialog-slide-description",children:[t(O,{style:{display:"flex",borderBottom:"1px solid #ccc",margin:"0 12px"},children:[e(Be,{style:{color:"red",fontSize:"32px"}}),e("span",{children:"Bạn có chắc chắn muốn xóa cấp bậc hàm này không?"})]}),e(I,{children:e("img",{className:"p-4 mx-auto",src:"https://www.iconexperience.com/_img/v_collection_png/256x256/shadow/garbage_delete.png",alt:"icon-trash"})}),t("div",{className:"flex justify-evenly pb-4",children:[t(y,{variant:"contained",color:"success",onClick:ie,children:[e(we,{})," Đồng ý"]}),t(y,{variant:"contained",color:"error",onClick:()=>q(),children:[e(E,{})," Cancel"]})]})]})]})};export{ta as default};
