import{X as $,j as e,S as oe,s as re,I as v,c as ce,a as F,u as se,o as de,an as ue,r as d,f as he,d as a,F as ge,P as pe,B as y,L as me,e as fe,H as be}from"./index-84f46720.js";import{d as xe,a as ye}from"./SaveAlt-f97a5b27.js";import{p as S}from"./index-4d501b15.js";import{T as ve,d as V,a as W,b as j,c as A}from"./LastPage-31dafe6e.js";import{d as T}from"./dayjs.min-321a62c3.js";import{T as Ce,a as Se,b as De,c as R,d as r,e as Pe,f as _e}from"./Edit-e94ab80e.js";import{d as ke,a as we,b as Te}from"./DeleteOutline-bae85395.js";import{d as Re}from"./AutoAwesomeMotion-fc47a6bd.js";import{D as O,d as E}from"./Cancel-9cf90a3e.js";import{c as $e}from"./commonApi-f45be029.js";import{S as Be}from"./index-de4d12fd.js";import{D as Ne}from"./index-faa10292.js";import{D as I,a as G}from"./DialogContent-c75aa98b.js";import{B as Y}from"./Box-ce147669.js";import{G as D}from"./Grid-ff6f187a.js";import{D as ze}from"./DialogActions-d9fa00ea.js";import"./KeyboardArrowRight-343d1488.js";import"./Toolbar-28e6c853.js";import"./MenuItem-6d965a5b.js";import"./axiosCommon-f4db16ce.js";const H=$.forwardRef(function(i,h){return e(oe,{direction:"up",ref:h,...i})}),qe=re(v)({position:"absolute",right:"16px",top:"4px"});function X(c){const i=be(),{count:h,page:u,rowsPerPage:n,onPageChange:p}=c,P=s=>{p(s,0)},f=s=>{p(s,u-1)},_=s=>{p(s,u+1)},b=s=>{p(s,Math.max(0,Math.ceil(h/n)-1))};return a(Y,{sx:{flexShrink:0,ml:2.5},children:[e(v,{onClick:P,disabled:u===0,"aria-label":"first page",children:i.direction==="rtl"?e(V,{}):e(W,{})}),e(v,{onClick:f,disabled:u===0,"aria-label":"previous page",children:i.direction==="rtl"?e(j,{}):e(A,{})}),e(v,{onClick:_,disabled:u>=Math.ceil(h/n)-1,"aria-label":"next page",children:i.direction==="rtl"?e(A,{}):e(j,{})}),e(v,{onClick:b,disabled:u>=Math.ceil(h/n)-1,"aria-label":"last page",children:i.direction==="rtl"?e(W,{}):e(V,{})})]})}X.propTypes={count:S.number.isRequired,onPageChange:S.func.isRequired,page:S.number.isRequired,rowsPerPage:S.number.isRequired};const Le=ce({chucvu:F().required("Vui lòng chọn chức vụ mới"),ngaygiuchucvu:F().required("Vui lòng chọn ngày bắt đầu giữ chức vụ")}).required(),at=()=>{var L;const c=se({defaultValues:{chucvu:"",ghichu:"",ngaygiuchucvu:T(Date.now())},resolver:de(Le)}),{canbo:i,onHandleSubmitEdit:h,onHandleSubmitDelete:u}=ue(),[n,p]=d.useState([]),[P,f]=d.useState(!1),[_,b]=d.useState(!1),[s,K]=d.useState([]),[o,J]=d.useState(null),[Q,U]=d.useState(null),C=he(t=>t.authReducer.roles_x01),[m,B]=$.useState(0),[g,Z]=$.useState(10),N=m>0?Math.max(0,(1+m)*g-(n==null?void 0:n.length)):0,ee=(t,l)=>{B(l)},te=t=>{Z(parseInt(t.target.value,10)),B(0)},z=()=>{f(!1)},q=()=>{b(!1)},ae=t=>{f(!0),J(t)},ne=t=>{b(!0),U(t)};d.useEffect(()=>{p(i==null?void 0:i.chucvu)},[i]),d.useEffect(()=>{(async()=>{try{let l=await $e.getChucvus();K(l.data.map(x=>({value:x._id,label:x.tenchucvu})))}catch(l){console.log(l.message)}})()},[]),d.useEffect(()=>{k("chucvu",(o==null?void 0:o.chucvu._id)||"",{shouldValidate:!0}),k("ngaygiuchucvu",T(o==null?void 0:o.tungay),{shouldValidate:!0}),k("ghichu",(o==null?void 0:o.ghichu)||"",{shouldValidate:!0})},[o]);const k=c.setValue,{isSubmitting:w}=c.formState,le=async t=>{let l={...t,id_edit:i._id,id_row:o._id};await h(l),f(!1)},ie=async()=>{let t={id_delete:i._id,id_row:Q};await u(t),b(!1)};return a("div",{children:[a("div",{className:"flex items-center space-x-2 mt-8 mb-4",children:[e(xe,{color:"info"}),e("span",{className:"text-md text-red-800 font-bold",children:"Lịch sử biến động chức vụ trong quá trình công tác"})]}),(n==null?void 0:n.length)>0&&a(ge,{children:[e(Ce,{component:pe,style:{overflowX:"scroll"},children:a(Se,{"aria-label":"custom pagination table",children:[e(De,{children:a(R,{children:[e(r,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#ed6c02",maxWidth:"250px"},children:"#"}),e(r,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#ed6c02",minWidth:"250px"},children:"Chức vụ"}),e(r,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#ed6c02",minWidth:"120px"},children:"Ngày giữ chức vụ"}),e(r,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#ed6c02",minWidth:"300px"},children:"Ghi chú"}),e(r,{align:"right",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#ed6c02"},children:"Thao tác"})]})}),a(Pe,{children:[(L=g>0?n==null?void 0:n.slice(m*g,m*g+g):n)==null?void 0:L.map((t,l)=>a(R,{children:[e(r,{className:"border-r border-slate-300",component:"th",scope:"row",children:m*g+l+1}),e(r,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:t.chucvu.tenchucvu}),e(r,{className:"border-r border-slate-300",align:"left",children:T(t.tungay).format("DD/MM/YYYY")}),e(r,{className:"border-r border-slate-300",align:"left",children:t.ghichu}),a(r,{align:"right",className:"border-r border-slate-300",children:[C&&C.includes("sửa biến động chức vụ")&&a(y,{variant:"contained",color:"success",size:"small",onClick:()=>ae(t),children:[e(_e,{style:{fontSize:"20px",marginRight:"4px"}})," ","Sửa"]}),C&&C.includes("xóa biến động chức vụ")&&a(y,{variant:"contained",color:"error",size:"small",style:{marginLeft:"4px"},onClick:()=>ne(t._id),children:[e(ke,{style:{fontSize:"20px",marginRight:"4px"}})," ","Xóa"]})]})]},t._id)),N>0&&e(R,{style:{height:53*N},children:e(r,{colSpan:6})})]})]})}),e("div",{children:e(ve,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:n==null?void 0:n.length,rowsPerPage:g,page:m,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:ee,onRowsPerPageChange:te,ActionsComponent:X,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:l,to:x,count:M}){return`hiển thị ${l} đến ${x} bản ghi trong tổng số ${M!==-1?M:`more than ${x}`} bản ghi`}})})]}),a(I,{maxWidth:"lg",fullWidth:!0,disableEscapeKeyDown:!0,onClose:(t,l)=>{l!=="backdropClick"&&z()},open:P,TransitionComponent:H,keepMounted:!0,"aria-describedby":"alert-dialog-slide-description",children:[a(O,{style:{display:"flex",borderBottom:"1px solid #ccc",margin:"0 12px"},children:[e(Re,{style:{color:"#333",fontSize:"32px"}}),e("span",{className:"text-red-800 font-semibold",children:"Thay đổi chức vụ công tác nâng cao"}),e(qe,{onClick:()=>z(),children:e(E,{style:{color:`${w?"#ccc":"#d32b2b"}`}})})]}),e(G,{children:a(Y,{children:[w?e(me,{}):"",a("form",{onSubmit:c.handleSubmit(le),style:{width:"100%"},children:[a(D,{container:!0,spacing:1,style:{alignItems:"center",justifyContent:"center"},children:[e(D,{item:!0,xs:12,md:6,lg:6,children:e(Be,{name:"chucvu",form:c,label:"Chức vụ công tác *",disabled:!1,options:s})}),e(D,{item:!0,xs:12,md:6,lg:6,children:e(Ne,{name:"ngaygiuchucvu",form:c,label:"Ngày nhận quyết định giữ chức vụ công tác *",disabled:!1})}),e(D,{item:!0,xs:12,md:12,lg:12,children:e(fe,{name:"ghichu",form:c,label:"Ghi chú",type:"text",disabled:!1})})]}),e(ze,{children:a(y,{color:"primary",variant:"contained",disabled:w,type:"submit",style:{margin:"4px auto"},children:[e(ye,{}),e("span",{className:"ml-2",children:"Lưu dữ liệu"})]})})]})]})})]}),a(I,{disableEscapeKeyDown:!0,onClose:(t,l)=>{l!=="backdropClick"&&q()},open:_,TransitionComponent:H,keepMounted:!0,"aria-describedby":"alert-dialog-slide-description",children:[a(O,{style:{display:"flex",borderBottom:"1px solid #ccc",margin:"0 12px"},children:[e(we,{style:{color:"red",fontSize:"32px"}}),e("span",{children:"Bạn có chắc chắn muốn xóa chức vụ này không?"})]}),e(G,{children:e("img",{className:"p-4 mx-auto",src:"https://www.iconexperience.com/_img/v_collection_png/256x256/shadow/garbage_delete.png",alt:"icon-trash"})}),a("div",{className:"flex justify-evenly pb-4",children:[a(y,{variant:"contained",color:"success",onClick:ie,children:[e(Te,{})," Đồng ý"]}),a(y,{variant:"contained",color:"error",onClick:()=>q(),children:[e(E,{})," Cancel"]})]})]})]})};export{at as default};
