import{X as $,j as e,S as ie,s as se,I as C,c as re,a as M,u as ce,o as de,an as ge,r as d,f as he,d as a,F as ue,P as pe,B as y,L as me,e as fe,H as be}from"./index-d7a9d146.js";import{d as xe,a as ye}from"./SaveAlt-36803218.js";import{p as D}from"./index-4d501b15.js";import{T as Ce,d as F,a as V,b as W,c as j}from"./LastPage-aaf572b5.js";import{d as T}from"./dayjs.min-4d8c5775.js";import{T as Se,a as De,b as Pe,c as R,d as s,e as _e,f as ke}from"./Edit-46ee4309.js";import{d as ve,a as we,b as Te}from"./DeleteOutline-48404f0a.js";import{d as Re}from"./AutoAwesomeMotion-48fa26b9.js";import{D as A,d as O}from"./Cancel-2fbf4918.js";import{c as $e}from"./commonApi-61f68a19.js";import{S as Be}from"./index-001a6bd7.js";import{D as Ne}from"./index-190acfca.js";import{D as E,a as I}from"./DialogContent-92029a8c.js";import{B as Y}from"./Box-8bb7873d.js";import{G as P}from"./Grid-c843cb60.js";import{D as He}from"./DialogActions-f19e4b53.js";import"./KeyboardArrowRight-1ebbd478.js";import"./Toolbar-8efd9b13.js";import"./MenuItem-b8340fcb.js";import"./axiosCommon-34ac3586.js";const G=$.forwardRef(function(o,h){return e(ie,{direction:"up",ref:h,...o})}),ze=se(C)({position:"absolute",right:"16px",top:"4px"});function X(r){const o=be(),{count:h,page:g,rowsPerPage:l,onPageChange:p}=r,_=c=>{p(c,0)},f=c=>{p(c,g-1)},k=c=>{p(c,g+1)},b=c=>{p(c,Math.max(0,Math.ceil(h/l)-1))};return a(Y,{sx:{flexShrink:0,ml:2.5},children:[e(C,{onClick:_,disabled:g===0,"aria-label":"first page",children:o.direction==="rtl"?e(F,{}):e(V,{})}),e(C,{onClick:f,disabled:g===0,"aria-label":"previous page",children:o.direction==="rtl"?e(W,{}):e(j,{})}),e(C,{onClick:k,disabled:g>=Math.ceil(h/l)-1,"aria-label":"next page",children:o.direction==="rtl"?e(j,{}):e(W,{})}),e(C,{onClick:b,disabled:g>=Math.ceil(h/l)-1,"aria-label":"last page",children:o.direction==="rtl"?e(V,{}):e(F,{})})]})}X.propTypes={count:D.number.isRequired,onPageChange:D.func.isRequired,page:D.number.isRequired,rowsPerPage:D.number.isRequired};const qe=re({hesoluong:M().required("Vui lòng chọn hệ số lương"),ngaylenluong:M().required("Vui lòng chọn ngày bắt đầu giữ hệ số lương")}).required(),at=()=>{var q;const r=ce({defaultValues:{hesoluong:"",ghichu:"",ngaylenluong:T(Date.now())},resolver:de(qe)}),{canbo:o,onHandleSubmitEditHesoluong:h,onHandleSubmitDeleteHesoluong:g}=ge(),[l,p]=d.useState([]),[_,f]=d.useState(!1),[k,b]=d.useState(!1),[c,K]=d.useState([]),[i,J]=d.useState(null),[Q,U]=d.useState(null),S=he(t=>t.authReducer.roles_x01),[m,B]=$.useState(0),[u,Z]=$.useState(10),N=m>0?Math.max(0,(1+m)*u-(l==null?void 0:l.length)):0,ee=(t,n)=>{B(n)},te=t=>{Z(parseInt(t.target.value,10)),B(0)},H=()=>{f(!1)},z=()=>{b(!1)},ae=t=>{f(!0),J(t)},le=t=>{b(!0),U(t)};d.useEffect(()=>{p(o==null?void 0:o.hesoluong)},[o]),d.useEffect(()=>{(async()=>{try{let n=await $e.getHesoluongs();K(n.data.map(x=>({value:x._id,label:x.hesoluong})))}catch(n){console.log(n.message)}})()},[]),d.useEffect(()=>{v("hesoluong",(i==null?void 0:i.hesoluong._id)||"",{shouldValidate:!0}),v("ngaylenluong",T(i==null?void 0:i.tungay),{shouldValidate:!0}),v("ghichu",(i==null?void 0:i.ghichu)||"",{shouldValidate:!0})},[i]);const v=r.setValue,{isSubmitting:w}=r.formState,ne=async t=>{let n={...t,id_edit:o._id,id_row:i._id};await h(n),f(!1)},oe=async()=>{let t={id_delete:o._id,id_row:Q};await g(t),b(!1)};return a("div",{children:[a("div",{className:"flex items-center space-x-2 mt-8 mb-4",children:[e(xe,{color:"info"}),e("span",{className:"text-md text-red-800 font-bold",children:"Lịch sử biến động hệ số lương trong quá trình công tác"})]}),(l==null?void 0:l.length)>0&&a(ue,{children:[e(Se,{component:pe,style:{overflowX:"scroll"},children:a(De,{"aria-label":"custom pagination table",children:[e(Pe,{children:a(R,{children:[e(s,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#ed6c02",maxWidth:"250px"},children:"#"}),e(s,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#ed6c02",minWidth:"250px"},children:"Hệ số lương"}),e(s,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#ed6c02",minWidth:"120px"},children:"Ngày thay đổi hệ số lương"}),e(s,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#ed6c02",minWidth:"300px"},children:"Ghi chú"}),e(s,{align:"right",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#ed6c02"},children:"Thao tác"})]})}),a(_e,{children:[(q=u>0?l==null?void 0:l.slice(m*u,m*u+u):l)==null?void 0:q.map((t,n)=>a(R,{children:[e(s,{className:"border-r border-slate-300",component:"th",scope:"row",children:m*u+n+1}),e(s,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:t.hesoluong.hesoluong}),e(s,{className:"border-r border-slate-300",align:"left",children:T(t.tungay).format("DD/MM/YYYY")}),e(s,{className:"border-r border-slate-300",align:"left",children:t.ghichu}),a(s,{align:"right",className:"border-r border-slate-300",children:[S&&S.includes("sửa biến động bậc hàm")&&a(y,{variant:"contained",color:"success",size:"small",onClick:()=>ae(t),children:[e(ke,{style:{fontSize:"20px",marginRight:"4px"}})," ","Sửa"]}),S&&S.includes("xóa biến động bậc hàm")&&a(y,{variant:"contained",color:"error",size:"small",style:{marginLeft:"4px"},onClick:()=>le(t._id),children:[e(ve,{style:{fontSize:"20px",marginRight:"4px"}})," ","Xóa"]})]})]},t._id)),N>0&&e(R,{style:{height:53*N},children:e(s,{colSpan:6})})]})]})}),e("div",{children:e(Ce,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:l==null?void 0:l.length,rowsPerPage:u,page:m,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:ee,onRowsPerPageChange:te,ActionsComponent:X,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:n,to:x,count:L}){return`hiển thị ${n} đến ${x} bản ghi trong tổng số ${L!==-1?L:`more than ${x}`} bản ghi`}})})]}),a(E,{maxWidth:"lg",fullWidth:!0,disableEscapeKeyDown:!0,onClose:(t,n)=>{n!=="backdropClick"&&H()},open:_,TransitionComponent:G,keepMounted:!0,"aria-describedby":"alert-dialog-slide-description",children:[a(A,{style:{display:"flex",borderBottom:"1px solid #ccc",margin:"0 12px"},children:[e(Re,{style:{color:"#333",fontSize:"32px"}}),e("span",{className:"text-red-800 font-semibold",children:"Thay đổi hệ số lương nâng cao"}),e(ze,{onClick:()=>H(),children:e(O,{style:{color:`${w?"#ccc":"#d32b2b"}`}})})]}),e(I,{children:a(Y,{children:[w?e(me,{}):"",a("form",{onSubmit:r.handleSubmit(ne),style:{width:"100%"},children:[a(P,{container:!0,spacing:1,style:{alignItems:"center",justifyContent:"center"},children:[e(P,{item:!0,xs:12,md:6,lg:6,children:e(Be,{name:"hesoluong",form:r,label:"Hệ số lương *",disabled:!1,options:c})}),e(P,{item:!0,xs:12,md:6,lg:6,children:e(Ne,{name:"ngaylenluong",form:r,label:"Ngày nhận quyết định thay đổi hệ số lương *",disabled:!1})}),e(P,{item:!0,xs:12,md:12,lg:12,children:e(fe,{name:"ghichu",form:r,label:"Ghi chú",type:"text",disabled:!1})})]}),e(He,{children:a(y,{color:"primary",variant:"contained",disabled:w,type:"submit",style:{margin:"4px auto"},children:[e(ye,{}),e("span",{className:"ml-2",children:"Lưu dữ liệu"})]})})]})]})})]}),a(E,{disableEscapeKeyDown:!0,onClose:(t,n)=>{n!=="backdropClick"&&z()},open:k,TransitionComponent:G,keepMounted:!0,"aria-describedby":"alert-dialog-slide-description",children:[a(A,{style:{display:"flex",borderBottom:"1px solid #ccc",margin:"0 12px"},children:[e(we,{style:{color:"red",fontSize:"32px"}}),e("span",{children:"Bạn có chắc chắn muốn xóa lần thay đổi hệ số lương này không?"})]}),e(I,{children:e("img",{className:"p-4 mx-auto",src:"https://www.iconexperience.com/_img/v_collection_png/256x256/shadow/garbage_delete.png",alt:"icon-trash"})}),a("div",{className:"flex justify-evenly pb-4",children:[a(y,{variant:"contained",color:"success",onClick:oe,children:[e(Te,{})," Đồng ý"]}),a(y,{variant:"contained",color:"error",onClick:()=>z(),children:[e(O,{})," Cancel"]})]})]})]})};export{at as default};
