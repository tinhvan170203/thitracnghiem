import{r as d,f as M,d as l,j as a,B as q,F as D,P as K,H as F,I as b,S as I,s as H,M as L}from"./index-7ef6efc8.js";import{m as W}from"./monthiApi-382fcde3.js";import{d as j}from"./Dashboard-030cb7f1.js";import{d as A}from"./dayjs.min-a93a5a07.js";import{p as k}from"./index-4d501b15.js";import{T as O,d as P,a as v,b as $,c as B}from"./LastPage-9062a904.js";import{c as S,d as o,f as Y,T as X,a as V,b as G,e as J}from"./Edit-2e348e58.js";import{B as Q}from"./Box-d340439b.js";import{d as U}from"./AutoAwesomeMotion-dbcbe853.js";import{D as Z,d as w}from"./Cancel-6d100af1.js";import{a as N}from"./Radio-d3322591.js";import{D as ee,a as ae}from"./DialogContent-12401076.js";import{C as te,d as ne}from"./index-824eb271.js";import"./KeyboardArrowRight-a6633d34.js";import"./Toolbar-e7b69645.js";import"./MenuItem-86de0376.js";function le(e){let n=e/1e3;const t=parseInt(n/3600);n=n%3600;const i=parseInt(n/60);return n=n%60,t===0?`${i}m:${n.toFixed()}s`:`${t}h:${i}m:${n.toFixed()}s`}const ie=({row:e,onClickOpenDialogEdit:n})=>{d.useState(null);const t=M(i=>i.authReducer.roles_x01);return l(S,{children:[a(o,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:e==null?void 0:e.thisinh.sbd}),a(o,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:e==null?void 0:e.thisinh.hoten}),a(o,{className:"border-r border-slate-300",align:"left",children:e==null?void 0:e.thisinh.capbac}),a(o,{className:"border-r border-slate-300",align:"left",children:e==null?void 0:e.thisinh.chucvu}),a(o,{className:"border-r border-slate-300",align:"left",children:e==null?void 0:e.thisinh.donvi.kyhieu}),a(o,{className:"border-r border-slate-300",align:"left",style:{fontWeight:"bold"},children:e==null?void 0:e.baithi.socaudung}),a(o,{className:"border-r border-slate-300",align:"left",children:e==null?void 0:e.solanthi}),a(o,{className:"border-r border-slate-300",align:"left",children:le(e.baithi.thoigiannopbai-e.baithi.thoigianbatdau)}),a(o,{align:"right",className:"bg-gray-300 flex justify-center items-center space-x-1",children:t&&t.includes("sửa câu hỏi")&&l(q,{variant:"contained",color:"success",size:"small",onClick:()=>n(e),children:[a(Y,{style:{fontSize:"20px"}}),"Xem bài thi"]})})]},e==null?void 0:e.thisinh._id)};function R(e){const n=F(),{count:t,page:i,rowsPerPage:c,onPageChange:s}=e,g=r=>{s(r,0)},f=r=>{s(r,i-1)},m=r=>{s(r,i+1)},p=r=>{s(r,Math.max(0,Math.ceil(t/c)-1))};return l(Q,{sx:{flexShrink:0,ml:2.5},children:[a(b,{onClick:g,disabled:i===0,"aria-label":"first page",children:n.direction==="rtl"?a(P,{}):a(v,{})}),a(b,{onClick:f,disabled:i===0,"aria-label":"previous page",children:n.direction==="rtl"?a($,{}):a(B,{})}),a(b,{onClick:m,disabled:i>=Math.ceil(t/c)-1,"aria-label":"next page",children:n.direction==="rtl"?a(B,{}):a($,{})}),a(b,{onClick:p,disabled:i>=Math.ceil(t/c)-1,"aria-label":"last page",children:n.direction==="rtl"?a(v,{}):a(P,{})})]})}R.propTypes={count:k.number.isRequired,onPageChange:k.func.isRequired,page:k.number.isRequired,rowsPerPage:k.number.isRequired};function se({list:e,onClickOpenDialogEdit:n}){const[t,i]=d.useState(0),[c,s]=d.useState(10),g=t>0?Math.max(0,(1+t)*c-e.length):0,f=(p,r)=>{i(r)},m=p=>{s(parseInt(p.target.value,10)),i(0)};return l(D,{children:[a(X,{component:K,children:l(V,{"aria-label":"custom pagination table",children:[a(G,{children:l(S,{children:[a(o,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#1976d2"},children:"SBD"}),a(o,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#1976d2",minWidth:"150px"},children:"Họ tên"}),a(o,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#1976d2"},children:"Cấp bậc"}),a(o,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#1976d2"},children:"Chức vụ"}),a(o,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#1976d2"},children:"Đơn vị công tác"}),a(o,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#1976d2"},children:"Số câu trả lời đúng"}),a(o,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#1976d2"},children:"Số lượt thi"}),a(o,{align:"left",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#1976d2"},children:"Thời gian làm bài thi"}),a(o,{align:"center",style:{fontSize:"14px",color:"#fff",padding:"8px 8px",backgroundColor:"#1976d2"},children:"Thao tác"})]})}),l(J,{children:[(c>0?e.slice(t*c,t*c+c):e).map(p=>a(ie,{row:p,onClickOpenDialogEdit:n},p.thisinh._id)),g>0&&a(S,{style:{height:53*g},children:a(o,{colSpan:6})})]})]})}),a("div",{children:a(O,{rowsPerPageOptions:[10,25,50,100,{label:"Tất cả",value:-1}],count:e.length,rowsPerPage:c,page:t,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},component:"div",onPageChange:f,onRowsPerPageChange:m,ActionsComponent:R,labelRowsPerPage:"Số bản ghi hiển thị trên mỗi trang",labelDisplayedRows:function({from:r,to:u,count:x}){return`hiển thị ${r} đến ${u} bản ghi trong tổng số ${x!==-1?x:`more than ${u}`} bản ghi`}})})]})}const C=(e,n,t)=>{if(e===n===t||e===t&&n!==t)return"primary";if(e!==t&&n===t)return"error"},oe=({question:e,index:n})=>{const[t,i]=d.useState(()=>e.choice);return d.useEffect(()=>{i(e.choice)},[e]),l("div",{className:"mb-8",children:[l("h4",{className:"font-semibold text-black",children:[l("span",{className:"text-red-600 font-bold",children:[e.question.answer===t?a("span",{className:"text-red-800",children:"(Đúng)"}):a("span",{className:"text-blue-800",children:"(Sai)"})," Câu ",n,":  "]}),e.question.question]}),l("ul",{className:"flex  flex-wrap",children:[l("li",{className:"flex items-start space-x-2 basis-1/2",children:[a(N,{name:e._id,checked:t==="option_a"||e.question.answer==="option_a",color:C(t,e.question.answer,"option_a")}),l("span",{className:"pt-2 text-black",children:[a("span",{className:"font-bold",children:"A."})," ",e.question.option_a]})]}),l("li",{className:"flex items-start space-x-2 basis-1/2",children:[a(N,{name:e._id,checked:t==="option_b"||e.question.answer==="option_b",color:C(t,e.question.answer,"option_b")}),l("span",{className:"pt-2 text-black",children:[a("span",{className:"font-bold",children:"B."})," ",e.question.option_b]})]}),l("li",{className:"flex items-start space-x-2 basis-1/2",children:[a(N,{name:e._id,checked:t==="option_c"||e.question.answer==="option_c",color:C(t,e.question.answer,"option_c")}),l("span",{className:"pt-2 text-black",children:[a("span",{className:"font-bold",children:"C."})," ",e.question.option_c]})]}),l("li",{className:"flex items-start space-x-2 basis-1/2",children:[a(N,{name:e._id,checked:t==="option_d"||e.question.answer==="option_d",color:C(t,e.question.answer,"option_d")}),l("span",{className:"pt-2 text-black",children:[a("span",{className:"font-bold",children:"D."})," ",e.question.option_d]})]})]})]})},ce=d.forwardRef(function(n,t){return a(I,{direction:"up",ref:t,...n})}),re=H(b)({position:"absolute",right:"16px",top:"4px"});function de({open:e,onCloseDialogEdit:n,item:t}){return a(D,{children:l(ee,{maxWidth:"lg",fullWidth:!0,disableEscapeKeyDown:!0,onClose:(i,c)=>{c!=="backdropClick"&&n(i,c)},open:e,TransitionComponent:ce,keepMounted:!0,"aria-describedby":"alert-dialog-slide-description",children:[l(Z,{style:{display:"flex",borderBottom:"1px solid #ccc",margin:"0 12px"},children:[a(U,{style:{color:"#333",fontSize:"32px"}}),l("span",{children:["Xem chi tiết bài thi của thí sinh ",t==null?void 0:t.thisinh.hoten," - SBD ",t==null?void 0:t.thisinh.sbd]}),a(re,{onClick:()=>n(),children:a(w,{style:{color:"#d32b2b"}})})]}),a(ae,{children:l("div",{className:"px-12 py-4 mx-10 mt-4",children:[a("p",{className:"mb-4",children:"Phương án thí sinh tích chọn có màu xanh da trời. Những câu hỏi thí sinh trả lời sai, đáp án đúng là đáp án được tô đỏ."}),(t==null?void 0:t.baithi.questions.length)>0&&(t==null?void 0:t.baithi.questions.map((i,c)=>a(oe,{question:i,index:c+1},i.question._id)))]})})]})})}let he=[{label:"SBD",key:"sbd"},{label:"Họ tên",key:"hoten"},{label:"Cấp bậc",key:"capbac"},{label:"Chức vụ",key:"chucvu"},{label:"Đơn vị",key:"donvi"},{label:"Số câu trả lời đúng",key:"socaudung"},{label:"Số lần thi",key:"solanthi"},{label:"Thời gian hoàn thành bài thi",key:"thoigianhoanthanh"}];function pe(e){let n=e/1e3;const t=parseInt(n/3600);n=n%3600;const i=parseInt(n/60);return n=n%60,t===0?`${i}m:${n.toFixed()}s`:`${t}h:${i}m:${n.toFixed()}s`}const Be=()=>{let{id:e}=L(),[n,t]=d.useState(0),[i,c]=d.useState(0),[s,g]=d.useState(null),[f,m]=d.useState([]),[p,r]=d.useState([]);const[u,x]=d.useState({status:!1,item:null}),E=T=>{x({item:T,status:!0})},z=()=>{x({...u,status:!1})};return d.useEffect(()=>{(async()=>{let y=await W.getKetquaThi(e);g(y.data.cuocthi),t(y.data.data.length);let _=0;y.data.data.forEach(h=>_+=h.solanthi),c(_),m(y.data.data),r(y.data.data.map(h=>({sbd:h.thisinh.sbd,hoten:h.thisinh.hoten,capbac:h.thisinh.capbac,chucvu:h.thisinh.chucvu,donvi:h.thisinh.donvi.kyhieu,socaudung:h.baithi.socaudung,solanthi:h.solanthi,thoigianhoanthanh:pe(h.baithi.thoigiannopbai-h.baithi.thoigianbatdau)})))})()},[e]),l("div",{className:"mx-2 bg-white pb-2 px-4 shadow-2xl py-2",children:[l("h3",{className:"flex items-center space-x-2",children:[a(j,{}),l("span",{className:"text-lg font-semibold",children:["Kết quả cuộc thi ",s==null?void 0:s.tencuocthi]})]}),l("ul",{className:"mt-2 ml-4",children:[l("li",{className:"text-gray-600 my-1",children:["Số lượng câu hỏi: ",a("span",{className:"font-bold ml-2 text-black",children:s==null?void 0:s.soluongcauhoi})]}),l("li",{className:"text-gray-600 my-1",children:["Thời gian làm bài: ",l("span",{className:"font-bold ml-2 text-black",children:[s==null?void 0:s.thoigianthi," phút"]})]}),l("li",{className:"text-gray-600 my-1",children:["Ngày thi: ",a("span",{className:"font-bold ml-2 text-black",children:A(s==null?void 0:s.ngaytochucthi).format("DD/MM/YYYY")})]}),l("li",{className:"text-gray-600 my-1",children:["Tổng số thí sinh dự thi: ",a("span",{className:"font-bold ml-2 text-black",children:n})]}),l("li",{className:"text-gray-600 my-1",children:["Tổng số lượt thi: ",a("span",{className:"font-bold ml-2 text-black",children:i})]})]}),a("h4",{className:"text-center my-4 font-bold",children:"Bảng thống kê kết quả thi xếp từ cao xuống thấp theo số lượng câu trả lời đúng"}),a("div",{className:"text-end mb-2",children:a(b,{children:a(te,{data:p,headers:he,filename:`ketquacuocthi_${s==null?void 0:s.tencuocthi}`,children:l("div",{className:"flex items-center shadow-md space-x-2 bg-green-300 px-2 py-1 rounded-md",children:[a(ne,{}),a("span",{className:"text-sm text-green-800",children:"Xuất file excel"})]})})})}),a(se,{list:f,item:u.item,onClickOpenDialogEdit:E}),a(de,{open:u.status,item:u.item,onCloseDialogEdit:z})]})};export{Be as default};
